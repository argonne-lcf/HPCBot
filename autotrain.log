Your installed package `nvidia-ml-py` is corrupted. Skip patch functions `nvmlDeviceGet{Compute,Graphics,MPSCompute}RunningProcesses`. You may get incorrect or incomplete results. Please consider reinstall package `nvidia-ml-py` via `pip3 install --force-reinstall nvidia-ml-py nvitop`.
Your installed package `nvidia-ml-py` is corrupted. Skip patch functions `nvmlDeviceGetMemoryInfo`. You may get incorrect or incomplete results. Please consider reinstall package `nvidia-ml-py` via `pip3 install --force-reinstall nvidia-ml-py nvitop`.
INFO     | 2024-07-10 13:13:45 | autotrain.app.ui_routes:<module>:31 - Starting AutoTrain...
INFO     | 2024-07-10 13:13:47 | autotrain.app.ui_routes:<module>:293 - AutoTrain started successfully
INFO     | 2024-07-10 13:13:47 | autotrain.app.app:<module>:13 - Starting AutoTrain...
INFO     | 2024-07-10 13:13:47 | autotrain.app.app:<module>:23 - AutoTrain version: 0.8.3
INFO     | 2024-07-10 13:13:47 | autotrain.app.app:<module>:24 - AutoTrain started successfully
INFO:     Started server process [3106149]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     127.0.0.1:60152 - "GET / HTTP/1.1" 307 Temporary Redirect
INFO:     127.0.0.1:60152 - "GET /ui/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:60152 - "GET /static/scripts/fetch_data_and_update_models.js?cb=2024-07-10%2013:13:54 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60152 - "GET /static/scripts/listeners.js?cb=2024-07-10%2013:13:54 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60158 - "GET /static/scripts/poll.js?cb=2024-07-10%2013:13:54 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60166 - "GET /static/scripts/utils.js?cb=2024-07-10%2013:13:54 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60178 - "GET /static/scripts/logs.js?cb=2024-07-10%2013:13:54 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60178 - "GET /ui/model_choices/llm%3Asft HTTP/1.1" 200 OK
INFO     | 2024-07-10 13:13:55 | autotrain.app.ui_routes:fetch_params:376 - Task: llm:sft
INFO:     127.0.0.1:60152 - "GET /ui/params/llm%3Asft/basic HTTP/1.1" 200 OK
INFO:     127.0.0.1:60166 - "GET /ui/accelerators HTTP/1.1" 200 OK
INFO:     127.0.0.1:60158 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO:     127.0.0.1:60178 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO:     127.0.0.1:60178 - "GET /ui/accelerators HTTP/1.1" 200 OK
INFO:     127.0.0.1:51138 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO:     127.0.0.1:51138 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO     | 2024-07-10 13:14:12 | autotrain.app.ui_routes:handle_form:491 - hardware: local-ui
INFO     | 2024-07-10 13:14:12 | autotrain.app.ui_routes:handle_form:607 - Task: lm_training
INFO     | 2024-07-10 13:14:12 | autotrain.app.ui_routes:handle_form:608 - Column mapping: {'text': 'text'}

Saving the dataset (0/1 shards):   0%|          | 0/317 [00:00<?, ? examples/s]
Saving the dataset (1/1 shards): 100%|██████████| 317/317 [00:00<00:00, 51961.64 examples/s]
Saving the dataset (1/1 shards): 100%|██████████| 317/317 [00:00<00:00, 51337.67 examples/s]

Saving the dataset (0/1 shards):   0%|          | 0/317 [00:00<?, ? examples/s]
Saving the dataset (1/1 shards): 100%|██████████| 317/317 [00:00<00:00, 55645.53 examples/s]
Saving the dataset (1/1 shards): 100%|██████████| 317/317 [00:00<00:00, 54975.99 examples/s]
INFO     | 2024-07-10 13:14:12 | autotrain.backends.local:create:8 - Starting local training...
WARNING  | 2024-07-10 13:14:12 | autotrain.commands:launch_command:45 - No GPU found. Forcing training on CPU. This will be super slow!
INFO     | 2024-07-10 13:14:12 | autotrain.commands:launch_command:400 - ['accelerate', 'launch', '--cpu', '-m', 'autotrain.trainers.clm', '--training_config', 'Polars-QA/training_params.json']
INFO     | 2024-07-10 13:14:12 | autotrain.commands:launch_command:401 - {'model': 'meta-llama/Meta-Llama-3-8B-Instruct', 'project_name': 'Polars-QA', 'data_path': 'Polars-QA/autotrain-data', 'train_split': 'train', 'valid_split': None, 'add_eos_token': True, 'block_size': 1024, 'model_max_length': 2048, 'padding': 'right', 'trainer': 'sft', 'use_flash_attention_2': False, 'log': 'tensorboard', 'disable_gradient_checkpointing': False, 'logging_steps': -1, 'eval_strategy': 'epoch', 'save_total_limit': 1, 'auto_find_batch_size': False, 'mixed_precision': 'fp16', 'lr': 3e-05, 'epochs': 3, 'batch_size': 2, 'warmup_ratio': 0.1, 'gradient_accumulation': 4, 'optimizer': 'adamw_torch', 'scheduler': 'linear', 'weight_decay': 0.0, 'max_grad_norm': 1.0, 'seed': 42, 'chat_template': 'none', 'quantization': 'int4', 'target_modules': 'all-linear', 'merge_adapter': False, 'peft': True, 'lora_r': 16, 'lora_alpha': 32, 'lora_dropout': 0.05, 'model_ref': None, 'dpo_beta': 0.1, 'max_prompt_length': 128, 'max_completion_length': None, 'prompt_text_column': 'autotrain_prompt', 'text_column': 'autotrain_text', 'rejected_text_column': 'autotrain_rejected_text', 'push_to_hub': True, 'username': 'btrungvo', 'token': '*****', 'unsloth': False}
INFO     | 2024-07-10 13:14:12 | autotrain.backends.local:create:13 - Training PID: 3106337
INFO:     127.0.0.1:51138 - "POST /ui/create_project HTTP/1.1" 200 OK
Traceback (most recent call last):
  File "/home/btrungvo/anaconda3/envs/LLM/bin/accelerate", line 5, in <module>
    from accelerate.commands.accelerate_cli import main
  File "/home/btrungvo/anaconda3/envs/LLM/lib/python3.11/site-packages/accelerate/commands/accelerate_cli.py", line 19, in <module>
    from accelerate.commands.estimate import estimate_command_parser
  File "/home/btrungvo/anaconda3/envs/LLM/lib/python3.11/site-packages/accelerate/commands/estimate.py", line 34, in <module>
    import timm
  File "/home/btrungvo/anaconda3/envs/LLM/lib/python3.11/site-packages/timm/__init__.py", line 2, in <module>
    from .layers import is_scriptable, is_exportable, set_scriptable, set_exportable
  File "/home/btrungvo/anaconda3/envs/LLM/lib/python3.11/site-packages/timm/layers/__init__.py", line 8, in <module>
    from .classifier import ClassifierHead, create_classifier, NormMlpClassifierHead
  File "/home/btrungvo/anaconda3/envs/LLM/lib/python3.11/site-packages/timm/layers/classifier.py", line 15, in <module>
    from .create_norm import get_norm_layer
  File "/home/btrungvo/anaconda3/envs/LLM/lib/python3.11/site-packages/timm/layers/create_norm.py", line 14, in <module>
    from torchvision.ops.misc import FrozenBatchNorm2d
  File "/home/btrungvo/anaconda3/envs/LLM/lib/python3.11/site-packages/torchvision/__init__.py", line 6, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils
  File "/home/btrungvo/anaconda3/envs/LLM/lib/python3.11/site-packages/torchvision/_meta_registrations.py", line 163, in <module>
    @torch._custom_ops.impl_abstract("torchvision::nms")
     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/btrungvo/anaconda3/envs/LLM/lib/python3.11/site-packages/torch/library.py", line 467, in inner
    handle = entry.abstract_impl.register(func_to_register, source)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/btrungvo/anaconda3/envs/LLM/lib/python3.11/site-packages/torch/_library/abstract_impl.py", line 30, in register
    if torch._C._dispatch_has_kernel_for_dispatch_key(self.qualname, "Meta"):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: operator torchvision::nms does not exist
INFO:     127.0.0.1:51138 - "GET /ui/accelerators HTTP/1.1" 200 OK
INFO     | 2024-07-10 13:14:15 | autotrain.app.utils:get_running_jobs:26 - Killing PID: 3106337
INFO     | 2024-07-10 13:14:15 | autotrain.app.utils:kill_process_by_pid:52 - Sent SIGTERM to process with PID 3106337
INFO:     127.0.0.1:55994 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO:     127.0.0.1:55994 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO:     127.0.0.1:55994 - "GET /ui/accelerators HTTP/1.1" 200 OK
INFO:     127.0.0.1:47402 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO:     127.0.0.1:47402 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO:     127.0.0.1:47402 - "GET /ui/accelerators HTTP/1.1" 200 OK
INFO:     127.0.0.1:56178 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO:     127.0.0.1:56178 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO:     127.0.0.1:56178 - "GET /ui/accelerators HTTP/1.1" 200 OK
INFO:     127.0.0.1:35230 - "GET /ui/is_model_training HTTP/1.1" 200 OK
INFO:     127.0.0.1:35230 - "GET /ui/is_model_training HTTP/1.1" 200 OK
